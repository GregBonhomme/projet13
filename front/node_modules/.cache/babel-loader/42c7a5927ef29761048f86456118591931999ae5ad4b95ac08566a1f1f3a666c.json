{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useEffect } from \"react\";\nimport { useStore } from \"react-redux\";\nfunction useToken(token) {\n  _s();\n  const [profile, setProfile] = useState(null);\n  const store = useStore();\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        const response = await fetch(\"http://localhost:3001/api/v1/user/profile\", {\n          method: \"POST\",\n          headers: {\n            \"content-type\": \"application/json; charset=utf-8\",\n            \"Authorization\": \"Bearer \" + token\n          }\n        });\n        const profileData = await response.json();\n        if (profileData.status === 200) {\n          const user = await profileData.body;\n          setProfile(user);\n          store.dispatch({\n            type: \"setFirstname\",\n            payload: user.firstName\n          });\n          store.dispatch({\n            type: \"setLastname\",\n            payload: user.lastName\n          });\n          store.dispatch({\n            type: \"setConnected\",\n            payload: true\n          });\n        } else {\n          setProfile(\"invalid\");\n        }\n      } catch (error) {\n        console.error(\"An error occured\", error);\n        setProfile(\"invalid\");\n      }\n    };\n    token && fetchData();\n  }, [token]);\n  return profile;\n}\n_s(useToken, \"2sLAiiqRExL8uJnlny+mqpBWNik=\", false, function () {\n  return [useStore];\n});\nexport default useToken;","map":{"version":3,"names":["useState","useEffect","useStore","useToken","token","_s","profile","setProfile","store","fetchData","response","fetch","method","headers","profileData","json","status","user","body","dispatch","type","payload","firstName","lastName","error","console"],"sources":["C:/Users/grego/Documents/temp/OpenClassroom/projet13/front/src/utils/useToken/index.js"],"sourcesContent":["import { useState,useEffect } from \"react\"\r\nimport { useStore } from \"react-redux\"\r\n\r\nfunction useToken (token) {\r\n\r\n    const [profile,setProfile] = useState(null)\r\n    const store = useStore()\r\n\r\n    useEffect (() => {\r\n        const fetchData = async() => {\r\n            try {\r\n                const response = await fetch(\"http://localhost:3001/api/v1/user/profile\",{\r\n                    method:\"POST\",\r\n                    headers:{\r\n                        \"content-type\":\"application/json; charset=utf-8\",\r\n                        \"Authorization\":\"Bearer \" + token\r\n                        }\r\n                    })\r\n                const profileData = await response.json()\r\n                \r\n                if (profileData.status === 200) {\r\n                    const user = await profileData.body\r\n                    setProfile(user)\r\n                    store.dispatch({type:\"setFirstname\",payload: user.firstName})\r\n                    store.dispatch({type:\"setLastname\" ,payload: user.lastName})\r\n                    store.dispatch({type:\"setConnected\",payload:true})\r\n                } else {\r\n                    setProfile(\"invalid\")\r\n                }\r\n            } catch (error) {\r\n                console.error(\"An error occured\",error)\r\n                setProfile(\"invalid\")\r\n            }\r\n        }\r\n        token && fetchData()\r\n    },[token])\r\n\r\n    return profile\r\n}\r\n\r\nexport default useToken"],"mappings":";AAAA,SAASA,QAAQ,EAACC,SAAS,QAAQ,OAAO;AAC1C,SAASC,QAAQ,QAAQ,aAAa;AAEtC,SAASC,QAAQA,CAAEC,KAAK,EAAE;EAAAC,EAAA;EAEtB,MAAM,CAACC,OAAO,EAACC,UAAU,CAAC,GAAGP,QAAQ,CAAC,IAAI,CAAC;EAC3C,MAAMQ,KAAK,GAAGN,QAAQ,CAAC,CAAC;EAExBD,SAAS,CAAE,MAAM;IACb,MAAMQ,SAAS,GAAG,MAAAA,CAAA,KAAW;MACzB,IAAI;QACA,MAAMC,QAAQ,GAAG,MAAMC,KAAK,CAAC,2CAA2C,EAAC;UACrEC,MAAM,EAAC,MAAM;UACbC,OAAO,EAAC;YACJ,cAAc,EAAC,iCAAiC;YAChD,eAAe,EAAC,SAAS,GAAGT;UAC5B;QACJ,CAAC,CAAC;QACN,MAAMU,WAAW,GAAG,MAAMJ,QAAQ,CAACK,IAAI,CAAC,CAAC;QAEzC,IAAID,WAAW,CAACE,MAAM,KAAK,GAAG,EAAE;UAC5B,MAAMC,IAAI,GAAG,MAAMH,WAAW,CAACI,IAAI;UACnCX,UAAU,CAACU,IAAI,CAAC;UAChBT,KAAK,CAACW,QAAQ,CAAC;YAACC,IAAI,EAAC,cAAc;YAACC,OAAO,EAAEJ,IAAI,CAACK;UAAS,CAAC,CAAC;UAC7Dd,KAAK,CAACW,QAAQ,CAAC;YAACC,IAAI,EAAC,aAAa;YAAEC,OAAO,EAAEJ,IAAI,CAACM;UAAQ,CAAC,CAAC;UAC5Df,KAAK,CAACW,QAAQ,CAAC;YAACC,IAAI,EAAC,cAAc;YAACC,OAAO,EAAC;UAAI,CAAC,CAAC;QACtD,CAAC,MAAM;UACHd,UAAU,CAAC,SAAS,CAAC;QACzB;MACJ,CAAC,CAAC,OAAOiB,KAAK,EAAE;QACZC,OAAO,CAACD,KAAK,CAAC,kBAAkB,EAACA,KAAK,CAAC;QACvCjB,UAAU,CAAC,SAAS,CAAC;MACzB;IACJ,CAAC;IACDH,KAAK,IAAIK,SAAS,CAAC,CAAC;EACxB,CAAC,EAAC,CAACL,KAAK,CAAC,CAAC;EAEV,OAAOE,OAAO;AAClB;AAACD,EAAA,CAnCQF,QAAQ;EAAA,QAGCD,QAAQ;AAAA;AAkC1B,eAAeC,QAAQ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}